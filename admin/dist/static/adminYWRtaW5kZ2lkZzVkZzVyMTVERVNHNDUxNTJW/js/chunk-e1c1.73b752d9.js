(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e1c1"],{"2XDT":function(t,e,a){"use strict";a.d(e,"j",function(){return s}),a.d(e,"a",function(){return n}),a.d(e,"d",function(){return r}),a.d(e,"k",function(){return l}),a.d(e,"b",function(){return o}),a.d(e,"f",function(){return c}),a.d(e,"i",function(){return u}),a.d(e,"e",function(){return d}),a.d(e,"c",function(){return p}),a.d(e,"h",function(){return g}),a.d(e,"g",function(){return m}),a.d(e,"l",function(){return h});var i=a("t3Un");function s(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/categorys/",method:"get",params:t})}function n(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/categorys/",method:"post",data:t})}function r(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/categorys/",method:"delete",data:t})}function l(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/tags/",method:"get",params:t})}function o(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/tags/",method:"post",data:t})}function c(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/tags/",method:"delete",data:t})}function u(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/",method:"get",params:t})}function d(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/",method:"delete",data:t})}function p(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/",method:"post",data:t})}function g(t,e){return Object(i.a)({url:"/api/v1/theory/admin/tasks/"+t+"/",method:"patch",data:e})}function m(t,e){return Object(i.a)({url:"/api/v1/theory/admin/tasks/"+t+"/",method:"delete"})}function h(t){return Object(i.a)({url:"/api/v1/theory/admin/tasks/"+t+"/",method:"get"})}},"9R3N":function(t,e,a){},Aelf:function(t,e,a){"use strict";var i=a("9R3N");a.n(i).a},X9En:function(t,e,a){"use strict";a.r(e);var i=a("Mz3J"),s=a("ZySA"),n=a("gyXm"),r=a("2XDT"),l=a("jJIE"),o=a.n(l),c={name:"TopicManagement",directives:{waves:s.a,clipboard:n.a},components:{Pagination:i.a},data:function(){return{tagDlg:!1,tagDlgAry:[],digTitle:"",tagtype:1,tagIds:[],tagQuery:{cn_name:"",content:""},headers:{"X-CSRF-Token":o.a.get("X-CSRF-Token")},subType:[],subTag:[],matchList:[],ids:[],listTotal:0,listPage:1,listQuery:{offset:0,limit:this.$store.state.config.row,search:"",tag_id:"",type_id:""},showImport:!1,fileList:[],importList:[],importOption:[],errList:[]}},created:function(){this.getCategorys(),this.getTags(),this.getList()},methods:{closeImport:function(){this.fileList=[],this.importList=[],this.importOption=[],this.errList=[]},getTags:function(){var t=this;Object(r.k)().then(function(e){t.subTag=e.data})},getCategorys:function(){var t=this;Object(r.j)().then(function(e){t.subType=e.data})},closeUpload:function(){this.fileList=[],this.importData=[]},handleExceed:function(){this.$message.error("请先删除之前导入的文件")},beforeAvatarUpload:function(t){t.name.substr(t.name.lastIndexOf("."));var e=t.size/1024/1024<1;return e||this.$message.error("文件大小不能超过 1MB!"),e},uploadSectionFile:function(t){var e=this,a=t.file,i=new FormData;i.append("file",a),this.axios({url:"/api/v1/theory/admin/tasks/import/",method:"post",data:i,headers:this.headers}).then(function(t){t.data.success?(e.$message.success("上传成功"),e.importOption=t.data.options,e.importList=t.data.data,e.errList=[]):(e.errList=t.data.message_zh,e.$message.error(t.data.message))}).catch(function(t){})},submitUpload:function(){this.$refs.upload.submit()},indexMethod:function(t){return(this.listPage-1)*this.listQuery.limit+t+1},getTag:function(){var t=this;Object(r.k)().then(function(e){t.tagAry=e.data,t.tagDlgAry=e.data})},getType:function(){var t=this;Object(r.j)().then(function(e){t.subType=e.data,t.tagDlgAry=e.data})},checkTag:function(t){this.tagIds=t.map(function(t){return t.id})},removeTagType:function(t){var e=this,a={ids:[]};a.ids.push(t),a.ids.length<=0||this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){1==e.tagtype&&Object(r.d)(a).then(function(t){t.data.success&&(e.$message.success("删除成功"),e.getType())}),2==e.tagtype&&Object(r.f)(a).then(function(t){t.data.success&&(e.$message.success("删除成功"),e.getTag(),e.getTags())})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},closetagDlg:function(){this.tagQuery={cn_name:"",content:""}},addTagType:function(){var t=this;this.tagQuery.cn_name.length>30?this.$message.error("名称长度应限制在30字以内"):""!==this.tagQuery.cn_name?(1==this.tagtype&&Object(r.a)(this.tagQuery).then(function(e){e.data.success&&(t.tagQuery={cn_name:"",content:""},t.$message.success("新增成功"),t.getType())}),2==this.tagtype&&Object(r.b)(this.tagQuery).then(function(e){e.data.success&&(t.tagQuery={cn_name:"",content:""},t.$message.success("新增成功"),t.getTag(),t.getTags())})):this.$message.error("请输入名称")},showTagDlg:function(t){this.tagtype=t,1==t?(this.digTitle="题目方向管理",this.tagDlgAry=this.subType,this.getType()):(this.digTitle="题目标签管理",this.tagDlgAry=this.tagAry,this.getTag()),this.tagDlg=!0},removeSub:function(){var t=this,e={};e.ids=this.ids,this.ids.length<=0||this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.e)(e).then(function(e){e.data.success&&(t.$message.success("操作成功"),t.getList())})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},addTopic:function(){this.$router.push({path:"/itemBank/theory/addTheory",query:{type:this.$route.name}})},editTopic:function(t){this.$router.push({path:"/itemBank/theory/editTheory",query:{task_id:t,type:this.$route.name}})},getList:function(t){var e=this;1===t&&(this.listPage=t),this.listQuery.offset=this.listPage,Object(r.i)(this.listQuery).then(function(t){var a=t.data;e.matchList=a.rows,e.listTotal=a.total,e.listTotal<=e.listQuery.offset*e.listQuery.limit-e.listQuery.limit&&0!=e.listTotal&&(e.listQuery.offset=e.listQuery.offset-1,e.getList())})},checkTable:function(t){this.ids=t.map(function(t){return t.id})}}},u=(a("Aelf"),a("ZrdR")),d=Object(u.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-select",{staticClass:"filter-item",attrs:{clearable:"",size:"mini",placeholder:"请选择题目类型"},model:{value:t.listQuery.type_id,callback:function(e){t.$set(t.listQuery,"type_id",e)},expression:"listQuery.type_id"}},[a("el-option",{attrs:{label:"判断",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"单选",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"多选",value:"2"}})],1),t._v(" "),a("el-select",{staticClass:"filter-item",attrs:{size:"mini",clearable:"",placeholder:"请选择题目标签"},model:{value:t.listQuery.tag_id,callback:function(e){t.$set(t.listQuery,"tag_id",e)},expression:"listQuery.tag_id"}},t._l(t.subTag,function(t,e){return a("el-option",{key:e,attrs:{label:t.cn_name,value:t.id}})})),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{size:"mini",clearable:"",placeholder:"请输入题目名称"},model:{value:t.listQuery.search,callback:function(e){t.$set(t.listQuery,"search","string"==typeof e?e.trim():e)},expression:"listQuery.search"}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"mini"},on:{click:function(e){t.getList(1)}}},[t._v("搜索\n    ")]),t._v(" "),a("div",{staticStyle:{float:"right"}},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"mini"},on:{click:function(e){t.showTagDlg(1)}}},[t._v("题目方向管理")]),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"mini"},on:{click:function(e){t.showTagDlg(2)}}},[t._v("题目标签管理")])],1)],1),t._v(" "),a("div",{staticClass:"filter-container"},[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.addTopic}},[t._v(" 新增")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:t.removeSub}},[t._v(" 删除")]),t._v(" "),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){t.showImport=!0}}},[t._v("\n      题目批量导入")]),t._v(" "),a("a",{staticStyle:{"margin-left":"10px"},attrs:{href:"/api/v1/theory/admin/tasks/choice/uploads/",download:""}},[a("el-button",{attrs:{type:"warning",size:"mini"}},[t._v(" 导入模板下载")])],1)],1),t._v(" "),a("div",{staticClass:"filter-container"},[a("el-table",{attrs:{data:t.matchList,border:""},on:{"selection-change":t.checkTable}},[a("el-table-column",{attrs:{align:"center",type:"selection"}}),t._v(" "),a("el-table-column",{attrs:{index:t.indexMethod,align:"center",type:"index",width:"50",label:"序号"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"title",label:"题目名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"text-align":"left"}},[t._v(t._s(e.row.title.length>20?e.row.title.substr(0,20)+"...":e.row.title))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"type_name",label:"题目类型"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"tag_name",label:"题目标签"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"answer",label:"答案"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{size:"mini",type:"success"},on:{click:function(a){t.editTopic(e.row.hash)}}},[t._v("编辑\n          ")])]}}])})],1)],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.listTotal>0,expression:"listTotal > 0"}],attrs:{total:t.listTotal,page:t.listPage,limit:t.listQuery.limit},on:{"update:page":function(e){t.listPage=e},"update:limit":function(e){t.$set(t.listQuery,"limit",e)},pagination:t.getList}}),t._v(" "),a("el-dialog",{attrs:{title:t.digTitle,visible:t.tagDlg,width:"780px"},on:{"update:visible":function(e){t.tagDlg=e},close:t.closetagDlg}},[a("el-form",{ref:"form",attrs:{"label-width":"0px"}},[a("el-form-item",{attrs:{label:""}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入名称"},model:{value:t.tagQuery.cn_name,callback:function(e){t.$set(t.tagQuery,"cn_name","string"==typeof e?e.trim():e)},expression:"tagQuery.cn_name"}})],1),t._v(" "),a("el-col",{staticStyle:{"margin-left":"30px"},attrs:{span:4}},[a("el-button",{attrs:{type:"success"},on:{click:t.addTagType}},[t._v("新增 ")])],1)],1)],1),t._v(" "),a("div",{staticStyle:{border:"1px solid rgb(240, 249, 235)"}},t._l(t.tagDlgAry,function(e){return a("el-tag",{key:e.id,staticClass:"mytag",staticStyle:{margin:"8px 20px",background:"#fff","border-color":"rgb(220, 220, 220)","border-radius":"43px"},attrs:{closable:"",size:"mini"},on:{close:function(a){t.removeTagType(e.id)}}},[a("el-tooltip",{staticClass:"item",attrs:{content:e.cn_name,effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{display:"inline-block",width:"80px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","font-size":"14px"}},[t._v("\n            "+t._s(e.cn_name)+"\n          ")])])],1)}))],1),t._v(" "),a("el-dialog",{attrs:{visible:t.showImport,title:"理论题批量导入"},on:{"update:visible":function(e){t.showImport=e},close:t.closeImport}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{limit:1,"on-exceed":t.handleExceed,"before-upload":t.beforeAvatarUpload,"http-request":t.uploadSectionFile,"file-list":t.fileList,"auto-upload":!1,action:""}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("上传到服务器")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n        只能上传excel文件，且不超过1MB\n      ")])],1),t._v(" "),a("el-table",{staticStyle:{"margin-top":"20px"},attrs:{data:t.importList,border:""}},[a("el-table-column",{attrs:{prop:"content",align:"center",label:"题目描述"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type_name",align:"center",label:"题目类型"}}),t._v(" "),t._l(t.importOption,function(e,i){return a("el-table-column",{key:i,attrs:{label:"答案"+e,prop:"address",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n          "+t._s(a.row.option[e])+"\n        ")]}}])})}),t._v(" "),a("el-table-column",{attrs:{prop:"answer",align:"center",label:"标准答案"}})],2),t._v(" "),a("div",t._l(t.errList,function(e){return a("p",{staticStyle:{color:"red",margin:"5px"}},[t._v(t._s(e))])}))],1)],1)},[],!1,null,"73fd6221",null);d.options.__file="index.vue";e.default=d.exports}}]);