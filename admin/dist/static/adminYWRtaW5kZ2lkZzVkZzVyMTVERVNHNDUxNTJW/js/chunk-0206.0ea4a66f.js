(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0206"],{"7EGT":function(e,t,r){"use strict";r.d(t,"f",function(){return a}),r.d(t,"d",function(){return i}),r.d(t,"h",function(){return o}),r.d(t,"e",function(){return l}),r.d(t,"g",function(){return u}),r.d(t,"a",function(){return s}),r.d(t,"b",function(){return c}),r.d(t,"c",function(){return m});var n=r("t3Un");function a(e){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_store_list/",method:"get",params:e})}function i(e){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_store/",method:"post",data:e})}function o(e){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_test/"+e,method:"post"})}function l(e){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_test/"+e,method:"delete"})}function u(e){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_test/"+e,method:"get"})}function s(e){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_store_list/",method:"post",data:e})}function c(e){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_store/",method:"get",params:e})}function m(e,t){return Object(n.a)({url:"/api/v1/ops/admin/setting/challenge_store/",method:"patch",params:e,data:t})}},Hm8v:function(e,t,r){"use strict";r.r(t);var n=r("omC7"),a=r.n(n),i=r("7EGT"),o=r("Ibrk"),l=r("i8oh"),u=r("tBjE"),s={components:{ChoiceImage:l.a,UploadFile:u.a},data:function(){return{selectMirror:!1,task_id:this.$route.query.task_id,tagAry:[],subType:[],templateList:[],flavorList:[],ruleForm:{title:"",challenge_type:"",label:"",level:0,image_type:"kvm",image_name:"",image_uuid:"",flavor_name:"",flavor_uuid:"",source_port:80,description:"",description_en:"",ops_score:"",checker_script:"",wp_official:"",file:""},rules:{title:[{required:!0,message:"请输入题目名称",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字",trigger:"blur"}],description:[{required:!0,message:"请输入题目描述",trigger:"blur"}],image_name:[{required:!0,message:"请输入镜像名称",trigger:"blur"}],source_port:[{required:!0,message:"请输入端口",trigger:"blur"}],challenge_type:[{required:!0,message:"请选择题目类型",trigger:"change"}],flavor_uuid:[{required:!0,message:"请选择实例模板",trigger:"change"}],label:[{required:!0,message:"请选择题目标签",trigger:"change"}],start_method:[{type:"number",required:!0,message:"请选择题目类型",trigger:"change"}],checker_script:[{required:!0,validator:function(e,t,r){r()},trigger:"blur"}]}}},created:function(){this.getType(),this.getTag(),this.getFlavorInfo(),this.task_id&&this.subInfo()},beforeDestroy:function(){this.$store.dispatch("changeMatchName","")},methods:{goBack:function(){history.back()},getType:function(){var e=this;Object(o.f)({type:3}).then(function(t){e.subType=t.data})},getTag:function(){var e=this;Object(o.e)({type:3}).then(function(t){e.tagAry=t.data})},subInfo:function(){var e=this,t={challenge_id:this.task_id};Object(i.b)(t).then(function(t){for(var r in e.$store.dispatch("changeMatchName",t.data.title),e.ruleForm)e.ruleForm[r]=t.data[r]})},flavorSelectedChange:function(e){var t=this;this.flavorList.forEach(function(r){r.uuid==e&&(t.ruleForm.flavor_name=r.name,t.ruleForm.flavor_message=a()(r.msg))})},getFlavorInfo:function(){var e=this;Object(o.h)({page:1,per_page:999}).then(function(t){e.flavorList=t.data.data})},onSubmit:function(){var e=this;if(""!==this.ruleForm.image_name)if(""!==this.ruleForm.checker_script){var t=this.ruleForm,r=new FormData;for(var n in t)r.append(n,t[n]);var a="/itemBank/DevOps/index";if(this.task_id){var o={challenge_id:this.task_id};Object(i.c)(o,r).then(function(t){t.data.success&&(e.$message.success("操作成功"),e.$router.push({path:a}))}).catch(function(t){e.$message.error(t.response.data.message_zh)})}else Object(i.a)(r).then(function(t){t.data.success&&(e.$message.success("操作成功"),e.$router.push({path:a}))})}else this.$message.error("请选择checker脚本");else this.$message.error("请选择镜像")},submitForm:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return e.$message.error("请核验所填写的信息"),!1;e.onSubmit()})},resetForm:function(){this.$refs.ruleForm.resetFields()},changeImageType:function(){this.ruleForm.image_name="",this.ruleForm.image_uuid=""}}},c=(r("zcbg"),r("ZrdR")),m=Object(c.a)(s,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container create_topic"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"200px"}},[r("el-form-item",{attrs:{label:"题目名称",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入题目名称"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title","string"==typeof t?t.trim():t)},expression:"ruleForm.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"题目类型",prop:"challenge_type"}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"请输入题目类型"},model:{value:e.ruleForm.challenge_type,callback:function(t){e.$set(e.ruleForm,"challenge_type",t)},expression:"ruleForm.challenge_type"}},e._l(e.subType,function(e,t){return r("el-option",{key:t,attrs:{label:e.cn_name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"题目标签",prop:"label"}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"请输入题目标签"},model:{value:e.ruleForm.label,callback:function(t){e.$set(e.ruleForm,"label",t)},expression:"ruleForm.label"}},e._l(e.tagAry,function(e,t){return r("el-option",{key:t,attrs:{label:e.cn_name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"题目难度"}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"题目难度"},model:{value:e.ruleForm.level,callback:function(t){e.$set(e.ruleForm,"level",t)},expression:"ruleForm.level"}},[r("el-option",{key:"1",attrs:{value:0,label:"初级"}}),e._v(" "),r("el-option",{key:"2",attrs:{value:1,label:"中级"}}),e._v(" "),r("el-option",{key:"3",attrs:{value:2,label:"高级"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"镜像类型",required:""}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"镜像类型"},on:{change:e.changeImageType},model:{value:e.ruleForm.image_type,callback:function(t){e.$set(e.ruleForm,"image_type",t)},expression:"ruleForm.image_type"}},[r("el-option",{attrs:{value:"kvm",label:"KVM"}}),e._v(" "),r("el-option",{attrs:{value:"docker",label:"docker"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"镜像选择",required:""}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.selectMirror=!0}}},[e._v("选择")]),e._v("\n      "+e._s(e.ruleForm.image_name)+"\n    ")],1),e._v(" "),r("el-form-item",{attrs:{prop:"flavor_uuid",label:"实例模板"}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择实例模板"},on:{change:e.flavorSelectedChange},model:{value:e.ruleForm.flavor_uuid,callback:function(t){e.$set(e.ruleForm,"flavor_uuid",t)},expression:"ruleForm.flavor_uuid"}},e._l(e.flavorList,function(e){return r("el-option",{key:e.uuid,attrs:{label:e.name+" / "+e.vcpus+"核 / "+e.memory+"MB / "+e.disk+"GB",value:e.uuid}})}))],1),e._v(" "),"docker"===e.ruleForm.image_type?r("el-form-item",{attrs:{label:"题目端口",prop:"source_port"}},[r("el-input-number",{attrs:{min:0,max:65535,precision:0,placeholder:"默认80端口"},model:{value:e.ruleForm.source_port,callback:function(t){e.$set(e.ruleForm,"source_port",t)},expression:"ruleForm.source_port"}})],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"题目描述",prop:"description"}},[r("el-input",{attrs:{rows:3,type:"textarea",placeholder:"请输入题目描述"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"题目描述英文"}},[r("el-input",{attrs:{rows:3,type:"textarea",placeholder:"请输入内容"},model:{value:e.ruleForm.description_en,callback:function(t){e.$set(e.ruleForm,"description_en",t)},expression:"ruleForm.description_en"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"考察点分值"}},[r("el-input",{model:{value:e.ruleForm.ops_score,callback:function(t){e.$set(e.ruleForm,"ops_score","string"==typeof t?t.trim():t)},expression:"ruleForm.ops_score"}}),e._v(" "),r("div",[e._v('例子：{"1":10, "2":20, "3":30}')]),e._v(" "),r("div",[e._v("\n        说明：冒号前面为考察点数，要放到双引号里，且要连续，冒号后为分数，考察点与分数都不能为0\n      ")])],1),e._v(" "),r("el-form-item",{attrs:{label:"checker脚本",prop:"checker_script"}},[r("UploadFile",{attrs:{file:e.ruleForm.checker_script,"file-type":["py"]},on:{"update:file":function(t){e.$set(e.ruleForm,"checker_script",t)}}}),e._v("\n      （请上传py格式文件，大小不超过2M）\n    ")],1),e._v(" "),r("el-form-item",{attrs:{label:"赛题WP"}},[r("UploadFile",{attrs:{file:e.ruleForm.wp_official,"file-type":["pdf","docx","md"]},on:{"update:file":function(t){e.$set(e.ruleForm,"wp_official",t)}}}),e._v("\n      （只支持pdf,docx,md格式,且大小不超过10M）\n    ")],1),e._v(" "),r("el-form-item",{attrs:{label:"题目附件"}},[r("UploadFile",{attrs:{file:e.ruleForm.file,"file-type":["zip"],"file-size":20971520},on:{"update:file":function(t){e.$set(e.ruleForm,"file",t)}}}),e._v("\n      （请上传zip格式文件，大小不超过20M）\n    ")],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保存\n      ")]),e._v(" "),r("el-button",{attrs:{type:"warning"},on:{click:e.goBack}},[e._v("返回")])],1)],1),e._v(" "),e.selectMirror?r("ChoiceImage",{attrs:{image_name:e.ruleForm.image_name,image_uuid:e.ruleForm.image_uuid,type:e.ruleForm.image_type,"select-mirror":e.selectMirror},on:{"update:image_name":function(t){e.$set(e.ruleForm,"image_name",t)},"update:image_uuid":function(t){e.$set(e.ruleForm,"image_uuid",t)},"update:selectMirror":function(t){e.selectMirror=t}}}):e._e()],1)},[],!1,null,null,null);m.options.__file="index.vue";t.default=m.exports},Ibrk:function(e,t,r){"use strict";r.d(t,"e",function(){return a}),r.d(t,"g",function(){return i}),r.d(t,"i",function(){return o}),r.d(t,"f",function(){return l}),r.d(t,"a",function(){return u}),r.d(t,"b",function(){return s}),r.d(t,"d",function(){return c}),r.d(t,"c",function(){return m}),r.d(t,"h",function(){return d});var n=r("t3Un");function a(e){return Object(n.a)({url:"/api/v1/common/admin/challenge/tags/",method:"get",params:e})}function i(){return Object(n.a)({url:"/api/v1/common/admin/flavors",method:"get",params:{per_page:9999}})}function o(){return Object(n.a)({url:"/api/v1/common/admin/images",method:"get"})}function l(e){return Object(n.a)({url:"/api/v1/common/admin/challenge/categorys/",method:"get",params:e})}function u(e){return Object(n.a)({url:"/api/v1/common/admin/challenge/tags/",method:"post",data:e})}function s(e){return Object(n.a)({url:"/api/v1/common/admin/challenge/categorys/",method:"post",data:e})}function c(e){return Object(n.a)({url:"/api/v1/common/admin/challenge/categorys/",method:"delete",data:e})}function m(e){return Object(n.a)({url:"/api/v1/common/admin/challenge/tags/",method:"delete",data:e})}function d(e){return Object(n.a)({url:"/api/v1/common/admin/flavors",method:"get",params:e})}},"MD+q":function(e,t,r){"use strict";r.d(t,"e",function(){return a}),r.d(t,"d",function(){return i}),r.d(t,"f",function(){return o}),r.d(t,"k",function(){return l}),r.d(t,"i",function(){return u}),r.d(t,"g",function(){return s}),r.d(t,"h",function(){return c}),r.d(t,"j",function(){return m}),r.d(t,"c",function(){return d}),r.d(t,"b",function(){return p}),r.d(t,"a",function(){return f});var n=r("t3Un");
//! 渗透赛获取题目列表
function a(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store_list",method:"get",params:e})}
//! 渗透赛获取题目标签options值
function i(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store_flag",method:"get",params:e})}function o(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store",method:"post",data:e})}function l(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store_list",method:"post",data:e})}
//! 获取题目类型
function u(){return Object(n.a)({url:"/api/v1/inf/admin/setting/categorys",method:"get"})}
//! 获取镜像列表
function s(e){return Object(n.a)({url:"/api/v1/common/admin/images",method:"get",params:e})}function c(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store",method:"get",params:e})}function m(e,t){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store",method:"patch",params:e,data:t})}function d(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store/test_env/"+e,method:"post"})}function p(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store/test_env/"+e,method:"delete"})}function f(e){return Object(n.a)({url:"/api/v1/inf/admin/setting/challenge_store/test_env/"+e,method:"get"})}},Q9Ml:function(e,t,r){},Y5bG:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),Math.easeInOutQuad=function(e,t,r,n){return(e/=n/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t};var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function a(e,t,r){var a=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,i=e-a,o=0;t=void 0===t?500:t;!function e(){o+=20,function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}(Math.easeInOutQuad(o,a,i,t)),o<t?n(e):r&&"function"==typeof r&&r()}()}},aFNf:function(e,t,r){var n=r("c01Q"),a=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},omC7:function(e,t,r){e.exports={default:r("aFNf"),__esModule:!0}},zcbg:function(e,t,r){"use strict";var n=r("Q9Ml");r.n(n).a}}]);