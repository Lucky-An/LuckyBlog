(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-412f"],{KN6t:function(t,e,n){"use strict";n.r(e);var r=n("Mz3J"),i=n("tBjE"),o=n("MD+q"),a=n("aFx9"),u={components:{Pagination:r.a,UploadFile:i.a},data:function(){return{id:this.$route.query.id,ruleForm:{name:"",compose_file:"",remark:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50个字符",trigger:"blur"}],remark:[{min:2,max:256,message:"长度在 2 到 256个字符",trigger:"blur"}]},selectMirror:!1,allMirrorList:[],selectMirrorList:[],total:0,listSelect:{search:"",per_page:10,page:1},multipleSelection:[]}},created:function(){this.id&&this.configInfo()},methods:{configInfo:function(){var t=this;Object(a.d)(this.id).then(function(e){var n=e.data.data;for(var r in t.ruleForm)t.ruleForm[r]=n[r];var i=n.image_uuids.split(",");t.selectMirrorList=i.map(function(t){return{uuid:t}})})},goBack:function(){history.back()},submitForm:function(t){var e=this;this.ruleForm.compose_file?this.$refs.ruleForm.validate(function(t){if(!t)return!1;var n=new FormData;for(var r in e.ruleForm)n.append(r,e.ruleForm[r]);e.id?Object(a.e)(e.id,n).then(function(t){t.data.success&&e.$router.push("/image/config")}):Object(a.a)(n).then(function(t){t.data.success&&e.$router.push("/image/config")})}):this.$message.error("请上传Compose file")},ChoiceImage:function(){this.selectMirror=!0,this.getMirrorList()},getMirrorList:function(t){var e=this;1===t&&(this.listSelect.page=1),Object(o.g)(this.listSelect).then(function(t){e.allMirrorList=t.data.data,e.total=t.data.total})},closed:function(){this.listSelect={search:"",per_page:10,page:1}},confirmSelect:function(){var t=this;this.ruleForm.image_names="",this.ruleForm.image_uuids="",this.selectMirrorList.forEach(function(e){t.ruleForm.image_names+=e.name+",",t.ruleForm.image_uuids+=e.uuid+","}),this.selectMirror=!1},handleSelectionChange:function(t){this.selectMirrorList=t}}},l=(n("n+el"),n("ZrdR")),c=Object(l.a)(u,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container addConfig"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"200px"}},[n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-input",{model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name","string"==typeof e?e.trim():e)},expression:"ruleForm.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Compose file",required:""}},[n("UploadFile",{attrs:{file:t.ruleForm.compose_file,"file-type":["yml"]},on:{"update:file":function(e){t.$set(t.ruleForm,"compose_file",e)}}}),t._v("\n      （请上传yml格式文件,大小不超过10M）\n    ")],1),t._v(" "),n("el-form-item",{attrs:{label:"备注",prop:"remark"}},[n("el-input",{attrs:{rows:8,type:"textarea"},model:{value:t.ruleForm.remark,callback:function(e){t.$set(t.ruleForm,"remark",e)},expression:"ruleForm.remark"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("保存")]),t._v(" "),n("el-button",{attrs:{type:"warning"},on:{click:t.goBack}},[t._v("返回")])],1)],1),t._v(" "),n("el-dialog",{attrs:{visible:t.selectMirror,title:"镜像选择",width:"60%"},on:{"update:visible":function(e){t.selectMirror=e},close:t.closed}},[n("div",{staticClass:"filter-container"},[n("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入镜像名称",size:"mini"},model:{value:t.listSelect.search,callback:function(e){t.$set(t.listSelect,"search","string"==typeof e?e.trim():e)},expression:"listSelect.search"}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.getMirrorList(1)}}},[t._v("搜索\n      ")])],1),t._v(" "),n("el-table",{ref:"MirrorListTable",attrs:{data:t.allMirrorList,border:"","row-key":"uuid"},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{"reserve-selection":!0,type:"selection",width:"55",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"镜像名称",prop:"name",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"镜像类型",prop:"image_type",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"is_base_image",label:"镜像来源",align:"center"}})],1),t._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listSelect.page,limit:t.listSelect.per_page},on:{"update:page":function(e){t.$set(t.listSelect,"page",e)},"update:limit":function(e){t.$set(t.listSelect,"per_page",e)},pagination:t.getMirrorList}}),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.confirmSelect}},[t._v("确 定")]),t._v(" "),n("el-button",{on:{click:function(e){t.selectMirror=!1}}},[t._v("取 消")])],1)],1)],1)},[],!1,null,null,null);c.options.__file="index.vue";e.default=c.exports},"MD+q":function(t,e,n){"use strict";n.d(e,"e",function(){return i}),n.d(e,"d",function(){return o}),n.d(e,"f",function(){return a}),n.d(e,"k",function(){return u}),n.d(e,"i",function(){return l}),n.d(e,"g",function(){return c}),n.d(e,"h",function(){return s}),n.d(e,"j",function(){return m}),n.d(e,"c",function(){return d}),n.d(e,"b",function(){return f}),n.d(e,"a",function(){return p});var r=n("t3Un");
//! 渗透赛获取题目列表
function i(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store_list",method:"get",params:t})}
//! 渗透赛获取题目标签options值
function o(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store_flag",method:"get",params:t})}function a(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store",method:"post",data:t})}function u(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store_list",method:"post",data:t})}
//! 获取题目类型
function l(){return Object(r.a)({url:"/api/v1/inf/admin/setting/categorys",method:"get"})}
//! 获取镜像列表
function c(t){return Object(r.a)({url:"/api/v1/common/admin/images",method:"get",params:t})}function s(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store",method:"get",params:t})}function m(t,e){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store",method:"patch",params:t,data:e})}function d(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store/test_env/"+t,method:"post"})}function f(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store/test_env/"+t,method:"delete"})}function p(t){return Object(r.a)({url:"/api/v1/inf/admin/setting/challenge_store/test_env/"+t,method:"get"})}},XaoH:function(t,e,n){},Y5bG:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),Math.easeInOutQuad=function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e};var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};function i(t,e,n){var i=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,o=t-i,a=0;e=void 0===e?500:e;!function t(){a+=20,function(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}(Math.easeInOutQuad(a,i,o,e)),a<e?r(t):n&&"function"==typeof n&&n()}()}},aFx9:function(t,e,n){"use strict";n.d(e,"i",function(){return i}),n.d(e,"a",function(){return o}),n.d(e,"l",function(){return a}),n.d(e,"d",function(){return u}),n.d(e,"e",function(){return l}),n.d(e,"j",function(){return c}),n.d(e,"n",function(){return s}),n.d(e,"c",function(){return m}),n.d(e,"h",function(){return d}),n.d(e,"g",function(){return f}),n.d(e,"k",function(){return p}),n.d(e,"b",function(){return g}),n.d(e,"f",function(){return h}),n.d(e,"m",function(){return v});var r=n("t3Un");function i(t){return Object(r.a)({url:"/api/v1/common/admin/compose_file",method:"get",params:t})}function o(t){return Object(r.a)({url:"/api/v1/common/admin/compose_file",method:"post",data:t})}function a(t){return Object(r.a)({url:"/api/v1/common/admin/compose_file",method:"delete",data:t})}function u(t){return Object(r.a)({url:"/api/v1/common/admin/compose_file/"+t,method:"get"})}function l(t,e){return Object(r.a)({url:"/api/v1/common/admin/compose_file/"+t,method:"patch",data:e})}function c(t){return Object(r.a)({url:"/api/v1/common/admin/entity/group",method:"get",params:t})}function s(t){return Object(r.a)({url:"/api/v1/common/admin/entity/group",method:"delete",data:t})}function m(t){return Object(r.a)({url:"/api/v1/common/admin/entity/group",method:"post",data:t})}function d(t){return Object(r.a)({url:"/api/v1/common/admin/entity/group/"+t,method:"get"})}function f(t,e){return Object(r.a)({url:"/api/v1/common/admin/entity/group/"+t,method:"patch",data:e})}function p(t){return Object(r.a)({url:"/api/v1/common/admin/entity",method:"get",params:t})}function g(t){return Object(r.a)({url:"/api/v1/common/admin/entity",method:"post",data:t})}function h(t,e){return Object(r.a)({url:"/api/v1/common/admin/entity/"+t,method:"patch",data:e})}function v(t){return Object(r.a)({url:"/api/v1/common/admin/entity",method:"delete",data:t})}},"n+el":function(t,e,n){"use strict";var r=n("XaoH");n.n(r).a}}]);